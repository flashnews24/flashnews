<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>فلاش نيوز | أخبار لحظة بلحظة</title>

  <!-- ✅ الأيقونة -->
  <link rel="icon" href="favicon.ico" type="image/x-icon" />

  <!-- ✅ خط Tajawal -->
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@500;700;800&display=swap" rel="stylesheet" />

  <!-- ✅ تنسيقات NewsFeed Lite (معدلة لفلاش نيوز) -->
  <style>
    :root {
      --primary-color: #5a2a82;
      --accent-color: #36d7b7;
      --bg-light: #fdfdfd;
      --bg-dark: #121212;
      --text-dark: #222;
      --text-light: #f0f0f0;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: 'Tajawal', sans-serif;
      background-color: var(--bg-light);
      color: var(--text-dark);
      transition: background 0.3s, color 0.3s;
    }

    body.dark {
      background-color: var(--bg-dark);
      color: var(--text-light);
    }

    header {
      background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
      padding: 25px 15px;
      color: white;
      text-align: center;
    }

    header img {
      height: 80px;
      margin-bottom: 10px;
    }

    nav {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      background-color: white;
      border-bottom: 1px solid #ddd;
      box-shadow: 0 2px 4px rgba(0,0,0,0.04);
    }

    nav a {
      padding: 12px 15px;
      text-decoration: none;
      color: var(--primary-color);
      font-weight: bold;
      transition: color 0.3s;
    }

    nav a:hover {
      color: var(--accent-color);
    }

    .ticker {
      background-color: #fafafa;
      padding: 10px;
      overflow: hidden;
      white-space: nowrap;
      border-top: 1px solid #eee;
      border-bottom: 1px solid #eee;
    }

    .ticker span {
      display: inline-block;
      padding-left: 100%;
      animation: scroll 25s linear infinite;
    }

    @keyframes scroll {
      0% { transform: translateX(0); }
      100% { transform: translateX(-100%); }
    }

    .controls {
      text-align: center;
      margin: 15px 0;
    }

    .controls button {
      margin: 5px;
      padding: 8px 14px;
      border: none;
      background: var(--accent-color);
      color: white;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
      transition: 0.3s;
    }

    .controls button:hover {
      background: #27b6a3;
    }

    input[type="search"] {
      width: 90%;
      max-width: 600px;
      padding: 10px;
      margin: 10px auto;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 1rem;
      display: block;
    }

    body.dark nav {
      background-color: #1a1a1a;
    }

    body.dark nav a {
      color: #ccc;
    }

    body.dark nav a:hover {
      color: var(--accent-color);
    }

    body.dark input[type="search"] {
      background-color: #2a2a2a;
      color: white;
      border: 1px solid #555;
    }
  </style>
</head>
<body>
  <!-- ✅ رأس الصفحة -->
  <header>
    <img src="logo.png" alt="شعار فلاش نيوز" />
    <h1>فلاش نيوز</h1>
    <div style="margin-top:10px;">
      <button onclick="toggleTheme()">🌓 الوضع</button>
      <button onclick="toggleLang()">🌐 <span id="lang-label">العربية</span></button>
    </div>
  </header>

  <!-- ✅ شريط الأخبار المتحرك -->
  <div class="ticker">
    <span id="ticker-text">📡 تحميل العناوين...</span>
  </div>

  <!-- ✅ التبويبات -->
  <div class="controls">
    <button onclick="filterByCategory('all')">📋 الكل</button>
    <button onclick="filterByCategory('global')">🌍 عالمي</button>
    <button onclick="filterByCategory('local')">🏠 محلي</button>
    <button onclick="filterByCategory('economy')">💼 اقتصاد</button>
    <button onclick="filterByCategory('sports')">⚽ رياضة</button>
    <button onclick="filterByCategory('tech')">💻 تكنولوجيا</button>
  </div>

  <!-- ✅ فلاتر المصدر -->
  <div class="controls" id="source-filters">
    <!-- يتم توليدها تلقائياً -->
  </div>

  <!-- ✅ خانة البحث -->
  <input type="search" id="search" placeholder="ابحث عن خبر..." oninput="searchNews()" />

  <!-- ✅ مكان عرض الأخبار -->
  <div class="container" id="news-container">
    <p style="text-align:center;">📰 يتم تحميل الأخبار الآن...</p>
  </div>
<script>
const sources = [
  {
    name: "الجزيرة",
    logo: "https://upload.wikimedia.org/wikipedia/ar/0/0b/Aljazeera_net_logo.png",
    category: "global",
    lang: "ar",
    url: "https://api.rss2json.com/v1/api.json?rss_url=https://www.aljazeera.net/aljazeera/rss"
  },
  {
    name: "سكاي نيوز عربية",
    logo: "https://upload.wikimedia.org/wikipedia/ar/thumb/d/d7/Sky_News_Arabia_Logo.svg/320px-Sky_News_Arabia_Logo.svg.png",
    category: "global",
    lang: "ar",
    url: "https://api.rss2json.com/v1/api.json?rss_url=https://www.skynewsarabia.com/web/rss/latest"
  },
  {
    name: "BBC Arabic",
    logo: "https://upload.wikimedia.org/wikipedia/commons/7/7c/BBC_News_Arabic.svg",
    category: "global",
    lang: "ar",
    url: "https://api.rss2json.com/v1/api.json?rss_url=http://www.bbc.co.uk/arabic/index.xml"
  },
  {
    name: "العربية",
    logo: "https://upload.wikimedia.org/wikipedia/commons/1/1b/AlArabiya.svg",
    category: "economy",
    lang: "ar",
    url: "https://api.rss2json.com/v1/api.json?rss_url=https://www.alarabiya.net/.mrss/ar.xml"
  },
  {
    name: "الشرق",
    logo: "https://upload.wikimedia.org/wikipedia/commons/c/ce/Asharq_News_logo.png",
    category: "economy",
    lang: "ar",
    url: "https://api.rss2json.com/v1/api.json?rss_url=https://www.asharq.com/ar/rss"
  }
];

let allNews = [];
let currentLang = navigator.language.startsWith('en') ? 'en' : 'ar';

function toggleTheme() {
  document.body.classList.toggle("dark");
}

function toggleLang() {
  currentLang = currentLang === 'ar' ? 'en' : 'ar';
  document.documentElement.lang = currentLang;
  document.documentElement.dir = currentLang === 'ar' ? 'rtl' : 'ltr';
  document.getElementById("lang-label").innerText = currentLang === 'ar' ? "العربية" : "English";
  renderNews();
}

function fetchNews() {
  const container = document.getElementById("news-container");
  container.innerHTML = '<p>📡 جاري تحميل الأخبار...</p>';
  allNews = [];

  sources.forEach(source => {
    fetch(source.url).then(res => res.json()).then(data => {
      const items = data.items.map(item => ({
        ...item,
        source: source.name,
        category: source.category,
        logo: source.logo,
        lang: source.lang,
        time: new Date(item.pubDate),
        id: item.guid || item.link,
        thumbnail: item.thumbnail || item.enclosure?.link || ""
      }));
      allNews.push(...items);
      renderNews();
    });
  });
}

let currentCategory = "all";
let currentSource = "all";

function filterByCategory(cat) {
  currentCategory = cat;
  renderNews();
}

function filterBySource(src) {
  currentSource = src;
  renderNews();
}

function searchNews() {
  renderNews();
}

function renderNews() {
  const container = document.getElementById("news-container");
  const ticker = document.getElementById("ticker-text");
  container.innerHTML = "";

  const searchText = document.getElementById("search").value.toLowerCase();

  let filtered = allNews.filter(n => {
    const inCat = currentCategory === "all" || n.category === currentCategory;
    const inSource = currentSource === "all" || n.source === currentSource;
    const inSearch = n.title.toLowerCase().includes(searchText);
    return inCat && inSource && inSearch;
  });

  filtered.sort((a, b) => b.time - a.time);

  ticker.innerText = filtered.slice(0, 5).map(n => n.title).join(" | ");

  // بناء الفلاتر
  const filters = document.getElementById("source-filters");
  filters.innerHTML = `<button onclick="filterBySource('all')">📡 الكل</button>`;
  [...new Set(allNews.map(n => n.source))].forEach(src => {
    filters.innerHTML += `<button onclick="filterBySource('${src}')">${src}</button>`;
  });

  filtered.forEach(item => {
    const card = document.createElement("div");
    card.className = "news-card";

    const isNew = (Date.now() - item.time.getTime()) < 3600000;
    const isFav = localStorage.getItem(item.id);

    card.innerHTML = `
      ${item.thumbnail ? `<img src="${item.thumbnail}" class="thumb" alt="صورة الخبر">` : ""}
      <h3 style="font-family:'Tajawal',sans-serif;font-weight:800;font-size:1.3rem;color:#4a148c;">
        <img src="${item.logo}" alt="" class="source-logo" style="height:18px;vertical-align:middle;margin-left:5px;" />
        ${item.title} ${isNew ? "<span style='color:red;'>🆕</span>" : ""}
      </h3>
      <small>📅 ${item.time.toLocaleDateString()} ⏰ ${item.time.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}</small>
      <p>${item.description?.slice(0, 150)}...</p>
      <div class="actions">
        <a href="${item.link}" target="_blank">🔗 اقرأ المزيد</a>
        <span class="fav-btn ${isFav ? 'active' : ''}" onclick="toggleFav('${item.id}', this)">⭐</span>
        <button onclick="navigator.clipboard.writeText('${item.link}'); alert('تم نسخ الرابط')">📤 مشاركة</button>
      </div>
    `;
    container.appendChild(card);
  });
}

function toggleFav(id, el) {
  if (localStorage.getItem(id)) {
    localStorage.removeItem(id);
    el.classList.remove("active");
  } else {
    localStorage.setItem(id, "true");
    el.classList.add("active");
  }
}

// تحديث تلقائي كل دقيقة
setInterval(fetchNews, 60000);
window.onload = () => {
  document.getElementById("lang-label").innerText = currentLang === 'ar' ? "العربية" : "English";
  fetchNews();
};
</script>
  <!-- ✅ الفوتر -->
  <footer style="text-align:center; padding: 20px; color:#666; font-size: 0.9rem;">
    جميع الحقوق محفوظة © فلاش نيوز 2025 | FlashNews
  </footer>

</body>
</html>
